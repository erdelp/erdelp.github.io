<!DOCTYPE html>
<html>
<head>
    <style>
        .card {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        .input-group {
            margin: 10px 0;
        }

        .label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
        }

        .results {
            margin-top: 20px;
        }

        .danger {
            color: red;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="card">
        <h2>Blackhole Calculator</h2>

        <div class="input-group">
            <label class="label">Start Date:</label>
            <input type="date" id="startDate" class="input">
        </div>

        <div class="input-group">
            <label class="label">Current Milestone:</label>
            <input type="number" id="milestone" class="input" min="0" max="6">
        </div>

        <div class="input-group">
            <label class="label">Freeze Days:</label>
            <input type="number" id="freezeDays" class="input" value="0" min="0">
        </div>

        <div id="results" class="results"></div>

        <div>
            <h3>Pace 24 Reference</h3>
            <table id="referenceTable">
                <tr>
                    <th>Milestone</th>
                    <th>Days at Pace 24</th>
                </tr>
            </table>
        </div>
    </div>

    <script>
		function formatDateEU(date) {
    return date.toLocaleDateString('en-GB', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
    });
}

        const milestoneData = [
            { milestone: 0, days: 45 },
            { milestone: 1, days: 118 },
            { milestone: 2, days: 178 },
            { milestone: 3, days: 306 },
            { milestone: 4, days: 447 },
            { milestone: 5, days: 644 },
            { milestone: 6, days: 730 }
        ];

        const WARNING_THRESHOLD = 14;

        function calculateBlackhole() {
            const startDate = document.getElementById('startDate').value;
            const milestone = parseInt(document.getElementById('milestone').value);
            const freezeDays = parseInt(document.getElementById('freezeDays').value) || 0;

            if (!startDate || isNaN(milestone) || milestone < 0 || milestone > 6) {
                document.getElementById('results').innerHTML = '';
                return;
            }

            const start = new Date(startDate);
            const today = new Date();
            const targetData = milestoneData.find(m => m.milestone === milestone);

            const deadlineDate = new Date(startDate);
            deadlineDate.setDate(deadlineDate.getDate() + targetData.days + freezeDays);

            const daysRemaining = Math.floor((deadlineDate - today) / (1000 * 60 * 60 * 24));
            const isOverdue = daysRemaining < 0;
            const isInDanger = daysRemaining < WARNING_THRESHOLD && daysRemaining >= 0;

            const originalDeadline = new Date(startDate);
            originalDeadline.setDate(originalDeadline.getDate() + targetData.days);

			let resultHTML = `
    <p><strong>Original Deadline:</strong> ${formatDateEU(originalDeadline)}</p>
    <p><strong>Days Remaining:</strong>
        <span class="${isOverdue || isInDanger ? 'danger' : ''}">
            ${isOverdue ? `OVERDUE by ${Math.abs(daysRemaining)} days` : `${daysRemaining} days`}
        </span>
    </p>
    <p><strong>Final Deadline (with freeze):</strong>
        <span class="${isOverdue || isInDanger ? 'danger' : ''}">${formatDateEU(deadlineDate)}</span>
    </p>
`;

            document.getElementById('results').innerHTML = resultHTML;
        }

        // Populate reference table
        const table = document.getElementById('referenceTable');
        milestoneData.forEach(data => {
            const row = table.insertRow();
            row.insertCell(0).textContent = data.milestone;
            row.insertCell(1).textContent = data.days;
        });

        // Add event listeners
        document.getElementById('startDate').addEventListener('change', calculateBlackhole);
        document.getElementById('milestone').addEventListener('input', calculateBlackhole);
        document.getElementById('freezeDays').addEventListener('input', calculateBlackhole);
    </script>
</body>
</html>
